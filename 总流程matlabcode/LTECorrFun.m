%% 自适应 （相关峰计算）function [ searchflag, timestart, corrdata ] = LTECorrFun( rxdata, corrlen, rsdata )% 输出参数： % rxmodify：同步后输出数据 % rimestart：时隙开始位置 % corrdata：同步码相关后数据 % 输入参数： % rxData：经过信道后数据 % prb_num：UE的RB个数 % rbstart：UE占用的无线资源块的起始位置 % UL_subframe_num：上行子帧时隙号 % cellid：小区ID %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% student code %%%%%%%%%%%%%%%%%%%%%%%%%%pssdata1 = ifft( rsdata, 2048 );pssdata = pssdata1( 1, 1:1024 );corr = zeros( 1, corrlen );for data_num = 1:corrlen    for n = 1:length( pssdata )        corr( data_num ) = corr( data_num ) + rxdata( data_num + n - 1 ) / pssdata( n );    end end corrdata = abs( corr );timestart = find( max( corrdata ) == corrdata );if max( corrdata ) > 2 * ( sum( corrdata ) - max( corrdata ) ) / ( corrlen - 1 )    searchflag = 1;else     searchflag = 0;end %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% end %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%end 